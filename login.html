<!DOCTYPE html>
<html lang="en" class="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Marcan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        // Initialize Firebase
        // Firebase config should be loaded from environment variables
        // For static HTML, you can create a config.js file or use data attributes
        const firebaseConfig = {
            apiKey: window.env?.NEXT_PUBLIC_FIREBASE_API_KEY || '',
            authDomain: window.env?.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN || '',
            projectId: window.env?.NEXT_PUBLIC_FIREBASE_PROJECT_ID || '',
            storageBucket: window.env?.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET || '',
            messagingSenderId: window.env?.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID || '',
            appId: window.env?.NEXT_PUBLIC_FIREBASE_APP_ID || ''
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Make auth available globally
        window.firebaseAuth = auth;

        // Login function
        window.loginUser = async (email, password) => {
            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Show success message
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.className = 'text-green-500 text-xs font-semibold mb-4 text-center';
                    errorDiv.textContent = 'Login successful! Redirecting...';
                }

                // Redirect to home page or dashboard after successful login
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1500);

                return user;
            } catch (error) {
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.className = 'text-marcan-red text-xs font-semibold mb-4 text-center';

                    // Handle different error types
                    switch (error.code) {
                        case 'auth/user-not-found':
                            errorDiv.textContent = 'No account found with this email.';
                            break;
                        case 'auth/wrong-password':
                            errorDiv.textContent = 'Incorrect password. Please try again.';
                            break;
                        case 'auth/invalid-email':
                            errorDiv.textContent = 'Invalid email address.';
                            break;
                        case 'auth/user-disabled':
                            errorDiv.textContent = 'This account has been disabled.';
                            break;
                        case 'auth/too-many-requests':
                            errorDiv.textContent = 'Too many failed attempts. Please try again later.';
                            break;
                        case 'auth/network-request-failed':
                            errorDiv.textContent = 'Network error. Please check your connection.';
                            break;
                        default:
                            errorDiv.textContent = error.message || 'An error occurred. Please try again.';
                    }
                }
                throw error;
            }
        };

        // Password reset function
        window.resetPassword = async (email) => {
            try {
                await sendPasswordResetEmail(auth, email);
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.className = 'text-green-500 text-xs font-semibold mb-4 text-center';
                    errorDiv.textContent = 'Password reset email sent! Check your inbox.';
                }
            } catch (error) {
                const errorDiv = document.getElementById('error-message');
                if (errorDiv) {
                    errorDiv.className = 'text-marcan-red text-xs font-semibold mb-4 text-center';
                    errorDiv.textContent = error.message || 'Failed to send password reset email.';
                }
            }
        };
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        marcan: {
                            red: '#ef4444',
                            glow: '#b91c1c',
                            dark: '#020617',
                            panel: '#0f172a',
                            glass: 'rgba(15, 23, 42, 0.85)'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        heading: ['Montserrat', 'sans-serif'],
                    },
                    boxShadow: {
                        'neon': '0 0 10px rgba(239, 68, 68, 0.5), 0 0 20px rgba(239, 68, 68, 0.3)',
                        'glass': '0 8px 32px 0 rgba(0, 0, 0, 0.37)',
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(239, 68, 68, 0.5);
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.08);
        }

        .glass-card {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
            border: 1px solid rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(4px);
        }

        .text-glow {
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.5);
        }

        .bg-grid {
            background-size: 50px 50px;
            background-image: linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
        }
    </style>
</head>

<body
    class="bg-marcan-dark text-slate-300 font-sans h-screen overflow-hidden flex selection:bg-marcan-red selection:text-white">

    <div class="fixed inset-0 z-0 pointer-events-none bg-grid">
        <div
            class="absolute top-[-20%] left-[-10%] w-[60%] h-[60%] bg-marcan-glow/20 rounded-full blur-[150px] animate-pulse-slow">
        </div>
        <div class="absolute bottom-[-20%] right-[-10%] w-[60%] h-[60%] bg-blue-900/10 rounded-full blur-[150px] animate-pulse-slow"
            style="animation-delay: 2s;"></div>
    </div>

    <aside
        class="relative z-20 w-20 lg:w-72 glass-panel flex flex-col justify-between py-8 px-4 transition-all duration-300">

        <a href="index.html" class="flex items-center gap-4 px-2 mb-10 cursor-pointer group">
            <div
                class="w-12 h-12 rounded-xl bg-gradient-to-br from-marcan-red to-red-900 flex items-center justify-center shadow-neon group-hover:scale-105 transition-transform duration-300">
                <span class="font-heading font-black text-2xl text-white">M</span>
            </div>
            <div class="hidden lg:block">
                <h1 class="font-heading font-bold text-xl text-white tracking-widest uppercase">Marcan</h1>
                <div class="flex items-center gap-1.5">
                    <span class="w-1.5 h-1.5 rounded-full bg-marcan-red shadow-neon"></span>
                    <span class="text-[10px] text-slate-400 font-bold uppercase tracking-wider">MFG Canada</span>
                </div>
            </div>
        </a>

        <nav class="flex-grow space-y-2">
            <a href="index.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-house text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">Home</span>
            </a>

            <a href="about.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-shield-halved text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">About Us</span>
            </a>

            <a href="directory.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-address-book text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">Directory</span>
            </a>

            <a href="wishlist.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-bullhorn text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">Buyer Wishlist</span>
                <span
                    class="hidden lg:flex ml-auto bg-marcan-red/20 text-marcan-red border border-marcan-red/50 text-[10px] font-bold px-2 py-0.5 rounded shadow-neon">New</span>
            </a>

            <a href="marketplace.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-shop text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">Supplier Listings</span>
            </a>

            <a href="contact.html"
                class="nav-item w-full flex items-center gap-4 px-4 py-4 rounded-xl text-slate-400 hover:text-white hover:bg-white/5 transition-all duration-300 group relative overflow-hidden">
                <div
                    class="absolute inset-0 bg-marcan-red/10 translate-x-[-100%] group-hover:translate-x-0 transition-transform duration-300">
                </div>
                <i class="fa-solid fa-envelope text-xl w-6 text-center"></i>
                <span class="hidden lg:block font-semibold text-sm tracking-wide">Contact Us</span>
            </a>
        </nav>

        <div class="mt-auto pt-6 border-t border-white/5">
            <a href="signup.html"
                class="w-full glass-card p-4 rounded-xl flex items-center gap-4 group hover:border-marcan-red/50 transition-colors duration-300">
                <div
                    class="w-10 h-10 rounded-lg bg-slate-800 flex items-center justify-center text-marcan-red border border-marcan-red/30 shadow-neon">
                    <i class="fa-solid fa-user-plus"></i>
                </div>
                <div class="hidden lg:block text-left">
                    <div class="text-xs font-bold text-slate-500 uppercase tracking-wider">Join Marcan</div>
                    <div class="text-sm font-bold text-white group-hover:text-marcan-red transition-colors">Sign Up
                    </div>
                </div>
            </a>
        </div>
    </aside>

    <main class="flex-1 relative z-10 overflow-hidden flex flex-col">

        <header
            class="h-20 px-8 flex justify-between items-center border-b border-white/5 bg-marcan-dark/30 backdrop-blur-sm z-30">
            <div class="flex items-center gap-3">
                <h2 class="font-heading font-bold text-white text-lg tracking-tight">Marcan Platform</h2>
                <span class="text-slate-600 text-lg">/</span>
                <span class="text-slate-400 text-sm font-medium">Login</span>
            </div>

            <div class="flex items-center gap-6">
                <div
                    class="hidden md:flex items-center gap-2 text-xs font-medium text-slate-400 hover:text-white cursor-pointer transition group">
                    <i class="fa-solid fa-location-dot text-marcan-red group-hover:shadow-neon transition-shadow"></i>
                    <span>Ontario, CA</span>
                    <i class="fa-solid fa-chevron-down text-[10px] ml-1 opacity-50"></i>
                </div>

                <div class="flex items-center gap-2 text-xs font-bold text-slate-400">
                    <span class="text-white cursor-pointer hover:text-marcan-red transition">EN</span>
                    <span class="opacity-30">|</span>
                    <span class="cursor-pointer hover:text-white transition">FR</span>
                </div>

                <div class="h-4 w-[1px] bg-white/10"></div>

                <div class="flex gap-3 items-center">
                    <a href="help.html"
                        class="w-9 h-9 rounded-lg border border-white/10 flex items-center justify-center hover:bg-white/5 transition text-slate-400 hover:text-white"
                        title="Support Center / Help">
                        <i class="fa-regular fa-circle-question"></i>
                    </a>
                    <a href="login.html"
                        class="px-5 py-2 rounded-lg bg-white/10 hover:bg-marcan-red border border-white/10 flex items-center justify-center text-white text-xs font-bold uppercase tracking-wider shadow-lg hover:shadow-neon transition-all">
                        Login
                    </a>
                </div>
            </div>
        </header>

        <div class="flex-1 overflow-y-auto p-8 relative">
            <div class="flex items-center justify-center h-full min-h-[500px]">
                <div class="glass-card p-10 rounded-3xl w-full max-w-md relative overflow-hidden">
                    <!-- Decor -->
                    <div
                        class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-marcan-red to-transparent shadow-neon">
                    </div>

                    <div class="text-center mb-8">
                        <h2 class="font-heading text-2xl font-black text-white uppercase tracking-widest mb-2">
                            Welcome Back</h2>
                        <p class="text-xs text-slate-500">Access your Marcan Dashboard</p>
                    </div>

                    <!-- Error/Success Message -->
                    <div id="error-message" class="text-xs font-semibold mb-4 text-center hidden"></div>

                    <form id="login-form" class="space-y-5">
                        <div class="space-y-1">
                            <label
                                class="text-[10px] font-bold text-marcan-red uppercase tracking-widest ml-1">Credentials</label>
                            <input type="email" id="email" name="email" placeholder="WORK EMAIL" required
                                class="w-full bg-black/40 border border-white/10 rounded-lg px-4 py-3 text-sm font-semibold text-white focus:border-marcan-red focus:shadow-neon outline-none placeholder:text-slate-500 mb-4">
                            <input type="password" id="password" name="password" placeholder="PASSWORD" required
                                class="w-full bg-black/40 border border-white/10 rounded-lg px-4 py-3 text-sm font-semibold text-white focus:border-marcan-red focus:shadow-neon outline-none placeholder:text-slate-500">
                        </div>

                        <div class="flex justify-between items-center text-xs text-slate-400">
                            <label class="flex items-center gap-2 cursor-pointer">
                                <input type="checkbox" id="remember-me"
                                    class="rounded border-white/20 bg-black/40 text-marcan-red focus:ring-0">
                                Remember me
                            </label>
                            <button type="button" id="forgot-password-btn"
                                class="hover:text-white transition-colors">Forgot
                                Password?</button>
                        </div>

                        <button type="submit" id="login-btn"
                            class="w-full bg-marcan-red text-white py-4 rounded-lg font-bold text-sm uppercase tracking-widest hover:shadow-neon hover:scale-[1.02] transition-all duration-300 mt-6 disabled:opacity-50 disabled:cursor-not-allowed">
                            <span id="login-btn-text">Login</span>
                            <span id="login-btn-loading" class="hidden">
                                <i class="fa-solid fa-spinner fa-spin mr-2"></i> Logging in...
                            </span>
                        </button>
                    </form>

                    <!-- Forgot Password Modal -->
                    <div id="forgot-password-modal"
                        class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm">
                        <div class="glass-card p-8 rounded-2xl w-full max-w-md relative">
                            <button id="close-forgot-modal"
                                class="absolute top-4 right-4 text-slate-400 hover:text-white transition-colors">
                                <i class="fa-solid fa-times text-xl"></i>
                            </button>
                            <h3 class="font-heading text-xl font-bold text-white mb-4">Reset Password</h3>
                            <p class="text-sm text-slate-400 mb-6">Enter your email address and we'll send you a link to
                                reset your password.</p>
                            <form id="forgot-password-form" class="space-y-4">
                                <input type="email" id="reset-email" placeholder="Email Address" required
                                    class="w-full bg-black/40 border border-white/10 rounded-lg px-4 py-3 text-sm font-semibold text-white focus:border-marcan-red focus:shadow-neon outline-none placeholder:text-slate-500">
                                <button type="submit"
                                    class="w-full bg-marcan-red text-white py-3 rounded-lg font-bold text-sm uppercase tracking-widest hover:shadow-neon transition-all">
                                    Send Reset Link
                                </button>
                            </form>
                        </div>
                    </div>

                    <div class="mt-6 text-center">
                        <p class="text-xs text-slate-500">Don't have an account? <a href="signup.html"
                                class="text-marcan-red font-bold hover:text-white transition-colors ml-1">Sign
                                Up</a></p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Form submission handler
        document.addEventListener('DOMContentLoaded', () => {
            const loginForm = document.getElementById('login-form');
            const loginBtn = document.getElementById('login-btn');
            const loginBtnText = document.getElementById('login-btn-text');
            const loginBtnLoading = document.getElementById('login-btn-loading');
            const errorDiv = document.getElementById('error-message');
            const forgotPasswordBtn = document.getElementById('forgot-password-btn');
            const forgotPasswordModal = document.getElementById('forgot-password-modal');
            const closeForgotModal = document.getElementById('close-forgot-modal');
            const forgotPasswordForm = document.getElementById('forgot-password-form');

            // Handle login form submission
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                // Get form values
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const rememberMe = document.getElementById('remember-me').checked;

                // Hide previous error messages
                if (errorDiv) {
                    errorDiv.classList.add('hidden');
                }

                // Show loading state
                loginBtn.disabled = true;
                loginBtnText.classList.add('hidden');
                loginBtnLoading.classList.remove('hidden');

                try {
                    // Call Firebase login function
                    if (window.loginUser) {
                        await window.loginUser(email, password);

                        // Store remember me preference
                        if (rememberMe) {
                            localStorage.setItem('rememberMe', 'true');
                        }
                    } else {
                        throw new Error('Firebase not initialized. Please check your configuration.');
                    }
                } catch (error) {
                    // Error handling is done in the loginUser function
                    console.error('Login error:', error);
                } finally {
                    // Reset loading state
                    loginBtn.disabled = false;
                    loginBtnText.classList.remove('hidden');
                    loginBtnLoading.classList.add('hidden');

                    // Show error message if it exists
                    if (errorDiv && errorDiv.textContent) {
                        errorDiv.classList.remove('hidden');
                    }
                }
            });

            // Forgot password button handler
            if (forgotPasswordBtn) {
                forgotPasswordBtn.addEventListener('click', () => {
                    if (forgotPasswordModal) {
                        forgotPasswordModal.classList.remove('hidden');
                    }
                });
            }

            // Close forgot password modal
            if (closeForgotModal) {
                closeForgotModal.addEventListener('click', () => {
                    if (forgotPasswordModal) {
                        forgotPasswordModal.classList.add('hidden');
                    }
                });
            }

            // Handle forgot password form submission
            if (forgotPasswordForm) {
                forgotPasswordForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const email = document.getElementById('reset-email').value;

                    if (window.resetPassword) {
                        await window.resetPassword(email);
                        setTimeout(() => {
                            forgotPasswordModal.classList.add('hidden');
                        }, 2000);
                    }
                });
            }

            // Check if user is already logged in
            if (window.firebaseAuth) {
                window.firebaseAuth.onAuthStateChanged((user) => {
                    if (user) {
                        // User is already logged in, redirect to home
                        window.location.href = 'index.html';
                    }
                });
            }
        });
    </script>

</body>

</html>